<nz-page-header *ngIf="restaurant && area" [nzGhost]="false">
  <nz-page-header-title>
    {{ area.name }}
  </nz-page-header-title>
  <nz-page-header-subtitle>
    <p nz-typography style="margin: 0">
      <span nz-icon nzType="shop"></span>
      {{ restaurant.name }}
    </p>
  </nz-page-header-subtitle>
  <nz-page-header-extra>
    <nz-space>
      <button
        *nzSpaceItem
        nz-button
        nzType="primary"
        nzShape="circle"
        nz-tooltip="编辑"
        i18n-nz-tooltip
        (click)="form()"
      >
        <span nz-icon nzType="edit"></span>
      </button>
      <button
        *nzSpaceItem
        nz-button
        nzType="primary"
        nzShape="circle"
        nz-tooltip="新增餐桌"
        i18n-nz-tooltip
        (click)="tableForm()"
      >
        <span nz-icon nzType="plus"></span>
      </button>
    </nz-space>
  </nz-page-header-extra>
  <nz-page-header-content>
    <nz-row nzJustify="space-between">
      <nz-col>
        <p nz-typography>
          <nz-space *ngIf="area.tea">
            <ng-container *nzSpaceItem>
              <span nz-icon nzType="coffee"></span> 茶水费 {{ area.tea.fee }} 元 / 位
            </ng-container>
            <ng-container *nzSpaceItem>
              <span nz-icon nzType="rise"></span> 茶水服务率 {{ area.tea.service }} %
            </ng-container>
            <ng-container *nzSpaceItem>
              <span nz-icon nzType="rise"></span> 茶水税率 {{ area.tea.tax }} %
            </ng-container>
          </nz-space>
        </p>

        <nz-space>
          <nz-segmented
            *nzSpaceItem
            [(ngModel)]="segmentIndex"
            [nzOptions]="segments"
            (nzValueChange)="getTables()"
          ></nz-segmented>
          <nz-input-group *nzSpaceItem style="width: 180px" nzSuffixIcon="search">
            <input
              (keyup.enter)="getTables()"
              [(ngModel)]="searchText"
              type="text"
              nz-input
              placeholder="搜索"
              i18n-placeholder
            />
          </nz-input-group>
          <nz-button-group *nzSpaceItem>
            <button nz-button nzType="text" nz-tooltip="刷新" i18n-nz-tooltip (click)="getTables()">
              <i nz-icon nzType="reload"></i>
            </button>
            <button nz-button nzType="text" nz-tooltip="重置" i18n-nz-tooltip (click)="clearSearch()">
              <i nz-icon nzType="clear"></i>
            </button>
          </nz-button-group>
        </nz-space>
      </nz-col>
      <nz-col> </nz-col>
      <nz-col>
        <nz-statistic [nzValue]="items.length" [nzTitle]="'餐桌数量'"></nz-statistic>
      </nz-col>
    </nz-row>
  </nz-page-header-content>
</nz-page-header>

<nz-content style="padding: 6px">
  <ng-template #emptyTpl>
    <nz-list-empty></nz-list-empty>
  </ng-template>
  <nz-list *ngIf="items.length !== 0; else emptyTpl" nzGrid>
    <nz-row [nzGutter]="16">
      <nz-col [nzXXl]="8" [nzXl]="12" *ngFor="let item of items">
        <nz-list-item cdkDrag>
          <nz-ribbon [nzText]="runtimeText | wpxMap : item.runtime" [nzColor]="runtimeColor | wpxMap : item.runtime">
            <nz-card nzHoverable (dblclick)="tableForm(item)" (contextmenu)="actions($event, actionsMenu, item)">
              <nz-space nzSize="middle">
                <ng-container *nzSpaceItem>
                  <nz-avatar nzShape="square" [nzSize]="100" [nzText]="item.sn" style="font-size: 32px"></nz-avatar>
                </ng-container>
                <div *nzSpaceItem>
                  <nz-descriptions [nzColumn]="2">
                    <nz-descriptions-item nzTitle="餐桌别名" i18n-nzTitle>
                      <ng-container *ngIf="item.alias; else nothingTpl">
                        {{ item.alias }}
                      </ng-container>
                    </nz-descriptions-item>
                    <nz-descriptions-item nzTitle="餐位" i18n-nzTitle>{{ item.seats }} </nz-descriptions-item>
                    <nz-descriptions-item nzTitle="最低消费" i18n-nzTitle [nzSpan]="2">
                      <ng-container *ngIf="item.minimum_spending; else infinityTpl">
                        {{ item.minimum_spending }} 元
                      </ng-container>
                      <ng-template #infinityTpl>无限额</ng-template>
                    </nz-descriptions-item>
                    <nz-descriptions-item nzTitle="动态" i18n-nzTitle [nzSpan]="2"> 暂无 </nz-descriptions-item>
                  </nz-descriptions>
                </div>
              </nz-space>
            </nz-card>
          </nz-ribbon>
        </nz-list-item>
      </nz-col>
    </nz-row>
  </nz-list>
</nz-content>

<nz-dropdown-menu #actionsMenu="nzDropdownMenu">
  <ul *ngIf="activated" nz-menu>
    <li nz-menu-item nzDisabled>
      <span>桌号：{{ activated.sn }}</span>
    </li>
    <li nz-menu-divider></li>
    <li nz-menu-item (click)="tableForm(activated)">编辑</li>
    <li nz-menu-item nzDanger (click)="tableDelete(activated)">删除</li>
  </ul>
</nz-dropdown-menu>

<ng-template #nothingTpl>暂无</ng-template>
