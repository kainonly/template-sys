<nz-page-header [nzGhost]="false">
  <nz-page-header-title>
    <ng-container *ngIf="areaDict[areaId!] as area; else allRef">
      <span>{{ area.name }}</span>
    </ng-container>
    <ng-template #allRef>
      <span i18n>全部餐台</span>
    </ng-template>
  </nz-page-header-title>
  <nz-page-header-tags *ngIf="areaDict[areaId!] as area">
    <nz-tag nzColor="blue">
      茶水费 <code>{{ area.tea.fee | currency }}</code> / 位
    </nz-tag>
    <nz-tag nzColor="blue">
      茶水服务率 <code>{{ area.tea.service }}%</code>
    </nz-tag>
    <nz-tag nzColor="blue">
      茶水税率 <code>{{ area.tea.tax }}%</code>
    </nz-tag>
  </nz-page-header-tags>
  <nz-page-header-extra>
    <nz-space>
      <ng-container *nzSpaceItem>
        <button nz-button nzType="primary" nzShape="circle" nz-tooltip="区位设置" i18n-nz-tooltip (click)="openAreas()">
          <span nz-icon nzType="setting" nzTheme="outline"></span>
        </button>
      </ng-container>
      <ng-container *nzSpaceItem>
        <button nz-button nzType="primary" nzShape="circle" nz-tooltip="新增餐桌" i18n-nz-tooltip (click)="form()">
          <span nz-icon nzType="plus" nzTheme="outline"></span>
        </button>
      </ng-container>
    </nz-space>
  </nz-page-header-extra>
  <nz-page-header-content>
    <nz-row nzJustify="space-between" nzAlign="bottom">
      <nz-col>
        <nz-space>
          <nz-segmented
            *nzSpaceItem
            [(ngModel)]="segmentIndex"
            [nzOptions]="segments"
            (nzValueChange)="getData()"
          ></nz-segmented>
          <nz-input-group *nzSpaceItem style="width: 180px" nzSuffixIcon="search">
            <input
              (keyup.enter)="getData()"
              [(ngModel)]="searchText"
              type="text"
              nz-input
              placeholder="搜索"
              i18n-placeholder
            />
          </nz-input-group>
          <nz-button-group *nzSpaceItem>
            <button nz-button nzType="text" nz-tooltip="刷新" i18n-nz-tooltip (click)="getData()">
              <span nz-icon nzType="reload"></span>
            </button>
            <button nz-button nzType="text" nz-tooltip="重置" i18n-nz-tooltip (click)="clear()">
              <span nz-icon nzType="clear"></span>
            </button>
          </nz-button-group>
        </nz-space>
      </nz-col>
      <nz-col> </nz-col>
      <nz-col>
        <span i18n>共计 {{ items.length }} 个餐台</span>
      </nz-col>
    </nz-row>
  </nz-page-header-content>
</nz-page-header>

<nz-content style="padding: 6px">
  <ng-template #emptyTpl>
    <nz-list-empty></nz-list-empty>
  </ng-template>
  <nz-list *ngIf="items.length !== 0; else emptyTpl" nzGrid>
    <nz-row [nzGutter]="16">
      <nz-col [nzXXl]="8" [nzXl]="12" *ngFor="let item of items">
        <nz-list-item cdkDrag>
          <nz-ribbon [nzText]="runtimeText | wpxMap : item.runtime" [nzColor]="runtimeColor | wpxMap : item.runtime">
            <nz-card nzHoverable (dblclick)="form(item)" (contextmenu)="actions($event, menu, item)">
              <nz-space nzSize="middle">
                <ng-container *nzSpaceItem>
                  <nz-avatar nzShape="square" [nzSize]="100" [nzText]="item.sn" style="font-size: 32px"></nz-avatar>
                </ng-container>
                <div *nzSpaceItem>
                  <nz-descriptions [nzColumn]="2">
                    <nz-descriptions-item nzTitle="餐桌别名" i18n-nzTitle>
                      <ng-container *ngIf="item.alias; else nothingRef">
                        {{ item.alias }}
                      </ng-container>
                    </nz-descriptions-item>
                    <nz-descriptions-item nzTitle="餐位" i18n-nzTitle>{{ item.seats }} </nz-descriptions-item>
                    <nz-descriptions-item nzTitle="最低消费" i18n-nzTitle [nzSpan]="2">
                      <ng-container *ngIf="item.minimum; else infinityTpl">
                        {{ item.minimum | currency }} 元
                      </ng-container>
                      <ng-template #infinityTpl>无限额</ng-template>
                    </nz-descriptions-item>
                    <nz-descriptions-item nzTitle="动态" i18n-nzTitle [nzSpan]="2"> 暂无 </nz-descriptions-item>
                  </nz-descriptions>
                </div>
              </nz-space>
            </nz-card>
          </nz-ribbon>
        </nz-list-item>
      </nz-col>
    </nz-row>
  </nz-list>
</nz-content>

<nz-dropdown-menu #menu="nzDropdownMenu">
  <ul *ngIf="actionData" nz-menu>
    <li nz-menu-item nzDisabled>
      <span>桌号：{{ actionData.sn }}</span>
    </li>
    <li nz-menu-divider></li>
    <li nz-menu-item (click)="form(actionData)">编辑</li>
    <li nz-menu-item nzDanger (click)="delete(actionData)">删除</li>
  </ul>
</nz-dropdown-menu>

<ng-template #nothingRef>暂无</ng-template>
